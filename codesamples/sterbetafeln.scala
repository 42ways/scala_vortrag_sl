// Sterbetafel 2009/2011 früheres Bundesgebiet (ohne West-Berlin) männlich
// https://www.destatis.de/DE/ZahlenFakten/GesellschaftStaat/Bevoelkerung/Sterbefaelle/Tabellen/SterbetafelFBNL.xls
val W_m_2009_2011 = Array(
    0.00400323, 0.00032858, 0.00019384, 0.00012938, 0.00012352, 0.00011247, 0.00010825, 0.00008650, 0.00007999, 0.00007755,
    0.00008935, 0.00008385, 0.00010379, 0.00010645, 0.00014993, 0.00017922, 0.00025623, 0.00033604, 0.00048112, 0.00048637,
    0.00051443, 0.00052063, 0.00051528, 0.00048373, 0.00054623, 0.00054453, 0.00056668, 0.00060955, 0.00060119, 0.00061786,
    0.00063296, 0.00069360, 0.00072006, 0.00076948, 0.00079058, 0.00082793, 0.00087024, 0.00092437, 0.00105705, 0.00109148,
    0.00119554, 0.00128162, 0.00143100, 0.00166167, 0.00184653, 0.00202807, 0.00229915, 0.00268115, 0.00296584, 0.00331492,
    0.00374575, 0.00446463, 0.00473777, 0.00521599, 0.00582000, 0.00639325, 0.00700749, 0.00768397, 0.00835693, 0.00910216,
    0.01006884, 0.01082845, 0.01176379, 0.01242976, 0.01392992, 0.01494268, 0.01629208, 0.01754197, 0.01889558, 0.02072380,
    0.02245289, 0.02449197, 0.02677660, 0.02924561, 0.03315464, 0.03675809, 0.04090447, 0.04579655, 0.05187792, 0.05778094,
    0.06439873, 0.07227104, 0.07969780, 0.08674014, 0.09751032, 0.10769205, 0.12002775, 0.13425422, 0.14579462, 0.16548791,
    0.17358914, 0.19708719, 0.21339218, 0.23145174, 0.25007594, 0.26920161, 0.28876520, 0.30870313, 0.32895208, 0.34944938,
    0.37013328)

// Sterbetafel 2009/2011 früheres Bundesgebiet (ohne West-Berlin) weiblich
// https://www.destatis.de/DE/ZahlenFakten/GesellschaftStaat/Bevoelkerung/Sterbefaelle/Tabellen/SterbetafelFBNL.xls
val W_w_2009_2011 = Array(
    0.00332634, 0.00025214, 0.00014849, 0.00011425, 0.00011686, 0.00010299, 0.00009287, 0.00008879, 0.00007630, 0.00006959,
    0.00006972, 0.00008424, 0.00007733, 0.00009037, 0.00010439, 0.00011872, 0.00015195, 0.00016468, 0.00023463, 0.00018955,
    0.00021520, 0.00021378, 0.00023078, 0.00021489, 0.00021130, 0.00021935, 0.00023059, 0.00024597, 0.00024677, 0.00028487,
    0.00027621, 0.00030343, 0.00035727, 0.00035991, 0.00042446, 0.00038863, 0.00046504, 0.00052608, 0.00054815, 0.00065383,
    0.00069044, 0.00078651, 0.00086271, 0.00102955, 0.00110501, 0.00125757, 0.00138373, 0.00159600, 0.00175535, 0.00203801,
    0.00220604, 0.00244239, 0.00277988, 0.00301066, 0.00322450, 0.00359504, 0.00377681, 0.00408376, 0.00451319, 0.00480589,
    0.00545460, 0.00578781, 0.00640114, 0.00688944, 0.00739725, 0.00794892, 0.00867026, 0.00919127, 0.00972296, 0.01059849,
    0.01157742, 0.01279568, 0.01434742, 0.01608320, 0.01828271, 0.02113118, 0.02409009, 0.02719487, 0.03142996, 0.03575792,
    0.04094148, 0.04690978, 0.05437605, 0.06203260, 0.07178501, 0.08201520, 0.09383549, 0.10750609, 0.12174578, 0.14041324,
    0.15301167, 0.17563882, 0.18704526, 0.20486420, 0.22327952, 0.24223005, 0.26165405, 0.28148952, 0.30167454, 0.32214758,
    0.34284780)

def klassische_sterbetafel(tafel: String, sex: String, age: Int): Double = {
    tafel match {
        case "2009/2011" => sex match {
            case "M" => W_m_2009_2011(age)
            case "W" => W_w_2009_2011(age)
        }
    }
}

def unisex_sterbetafel(tafel: String, age: Int): Double = {
    // Ganz banale Idee für Demozwecke: Wir nehmen den Durchschnitt zwischen Männlein und Weiblein
    (klassische_sterbetafel(tafel, "M", age) + klassische_sterbetafel(tafel, "W", age)) / 2
}

def bmi_sterbetafel(tafel: String, sex: String, groesse: Int, gewicht: Double, age: Int): Double = {
    // Ganz banale Idee für Demozwecke: Body Mass Index-Abweichung zum "Normalwert" von 22 in % zuschlagen
    val bmi = gewicht / (groesse / 100.0 * groesse / 100.0)
    klassische_sterbetafel(tafel, sex, age) * ( 1 + (bmi - 22).abs * 0.01)
}
